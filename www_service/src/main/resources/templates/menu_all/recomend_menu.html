<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ÎÇ†Ïî® Í∏∞Î∞ò Î©îÎâ¥ Ï∂îÏ≤ú</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .weather-container {
            padding: 20px;
            margin-top: 20px;
            border-radius: 8px;
            text-align: center;
        }
        .weather-item {
            font-size: 16px;  
        }
        .weather-icon {
            font-size: 20px;
            margin: 0 5px; 
            vertical-align: middle; 
        }
        .menu-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        .menu-item {
            width: 200px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        .menu-item:nth-child(1) { background-color: #ffb3ba; }
        .menu-item:nth-child(2) { background-color: #baffc9; }
        .menu-item:nth-child(3) { background-color: #bae1ff; }
        .menu-item:nth-child(4) { background-color: #ffffba; }
        .menu-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }
        .menu-info {
            padding: 15px;
            text-align: center;
        }
        .menu-name {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .menu-button {
            background-color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <div id="weather-container" class="weather-container">
    </div>
    <h1>ÌòÑÏû¨ ÎÇ†Ïî®Ïóê Ïù¥Îü∞ Î©îÎâ¥ Ïñ¥ÎïåÏöî?</h1>
    <div id="menu-list" class="menu-list">
    </div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const apiKey = '5ec2a8343328554022efe9f92a7fdfa3';
        const cityName = 'Busan';
        const url = `http://api.openweathermap.org/data/2.5/weather?q=${cityName}&appid=${apiKey}`;

        const weatherMapping = {
            'clear sky': 'ÎßëÏùå',
            'few clouds': 'ÎßëÏùå',
            'scattered clouds': 'ÎßëÏùå',
            'broken clouds': 'ÌùêÎ¶º',
            'overcast clouds': 'ÌùêÎ¶º',
            'light rain': 'ÎπÑ',
            'moderate rain': 'ÎπÑ',
            'heavy intensity rain': 'ÎπÑ',
            'shower rain': 'ÎπÑ',
            'rain': 'ÎπÑ',
            'thunderstorm': 'ÎπÑ',
            'snow': 'Îàà',
            'mist': 'ÏïàÍ∞ú',
            'fog': 'ÏïàÍ∞ú',
            'haze': 'ÏïàÍ∞ú',
            'smoke': 'ÏïàÍ∞ú',
            'dust': 'ÏïàÍ∞ú',
            'sand': 'ÏïàÍ∞ú',
            'ash': 'ÏïàÍ∞ú',
            'squalls': 'ÎπÑ',
            'tornado': 'ÎπÑ'
        };

        const weatherIcons = {
            'ÎßëÏùå': '‚òÄÔ∏è',
            'ÌùêÎ¶º': '‚òÅÔ∏è',
            'ÎπÑ': 'üåßÔ∏è',
            'Îàà': '‚ùÑÔ∏è',
            'ÏïàÍ∞ú': 'üå´Ô∏è'
        };

        const menuImages = {
            'ÎùºÎ©ò': 'ramen.jpg',
            'ÎèàÏπ¥Ï∏†': 'tonkatsu.png',
            'Ïß¨ÎΩï': 'jjamppong.png',
            'Îî§ÏÑ¨': 'dim_sum.png',
            'ÍπÄÏπòÏ∞åÍ∞ú': 'kimchi_stew.png',
            'ÏÜåÎ∞î': 'soba.jpg',
            'Ïä§ÌÖåÏù¥ÌÅ¨': 'steak.png',
            'ÏÇºÍ≥ÑÌÉï': 'samgyetang.png',
            'ÌïòÏù¥ÎùºÏù¥Ïä§': 'hayashi_rice.png',
            'ÏôÄÌîå': 'waffles.png',
            'ÎèôÌÉúÏ∞åÍ∞ú': 'dongtae_jjigae.png',
            'Ìò∏Î∞ïÏ£Ω': 'hobak_juk.png'
        };

        fetch(url)
            .then(response => response.json())
            .then(data => {
                const weatherContainer = document.getElementById('weather-container');
                const date = new Date(data.dt * 1000);
                const formattedDate = date.toISOString().split('T')[0];
                const temp = (data.main.temp - 273.15).toFixed(2);
                const description = data.weather[0].description;
                const simplifiedDescription = weatherMapping[description] || 'ÎßëÏùå';
                const icon = weatherIcons[simplifiedDescription] || '‚òÄÔ∏è';

                const content = `
                    <div class="weather-item">
                        ${temp}¬∞C <span class="weather-icon">${icon}</span> ${simplifiedDescription}
                    </div>
                `;

                weatherContainer.innerHTML = content;

                // Ïò®ÎèÑÏóê Îî∞Î•∏ Î©îÎâ¥ Ï∂îÏ≤ú
                let recommendedMenus;
                if (temp < 26) {
                    recommendedMenus = ['ÎùºÎ©ò', 'ÎèàÏπ¥Ï∏†', 'Ïß¨ÎΩï', 'Îî§ÏÑ¨'];
                } else if (temp >= 26 && temp < 27) {
                    recommendedMenus = ['ÍπÄÏπòÏ∞åÍ∞ú', 'ÏÜåÎ∞î', 'Ïä§ÌÖåÏù¥ÌÅ¨', 'ÏÇºÍ≥ÑÌÉï'];
                } else {
                    recommendedMenus = ['ÌïòÏù¥ÎùºÏù¥Ïä§', 'ÏôÄÌîå', 'ÎèôÌÉúÏ∞åÍ∞ú', 'Ìò∏Î∞ïÏ£Ω'];
                }

                const menuList = document.getElementById('menu-list');
                menuList.innerHTML = recommendedMenus.map(menu => `
                    <div class="menu-item" onclick="sendMenuName(this)">
                        <img src="/uploads/${menuImages[menu] || 'default.jpg'}" alt="${menu}">
                        <div class="menu-info">
                            <div class="menu-name">${menu}</div>
                        </div>
                    </div>
                `).join('');
            })
            .catch(error => console.error('Error fetching weather data:', error));
    });

    function sendMenuName(element) {
        const menuName = element.querySelector('.menu-name').textContent;
        window.location.href = `/menu_all/recipe_list_name?menuName=${menuName}`;
    }
</script>
</body>
</html>