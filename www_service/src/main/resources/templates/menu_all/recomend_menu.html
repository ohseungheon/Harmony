<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
    </style>
</head>
<body>
<header>
    <th:block th:insert="~{/sub/header.html}"></th:block>
</header>
<section>
    <h1 style="text-align: center;">í˜„ì¬ ë‚ ì”¨</h1>
    <table id="weather-table">
        <thead>
            <tr>
                <th>ë‚ ì§œ</th>
                <th>í˜„ì¬ ì˜¨ë„(Â°C)</th>
                <th>ë‚ ì”¨</th>
                <th>ì¶”ì²œ ë©”ë‰´</th>
            </tr>
        </thead>
        <tbody id="weather-body">
        </tbody>
    </table>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const apiKey = '5ec2a8343328554022efe9f92a7fdfa3';
        const cityName = 'Busan';
        const url = `http://api.openweathermap.org/data/2.5/weather?q=${cityName}&appid=${apiKey}`;

        const weatherMapping = {
            'clear sky': 'ë§‘ìŒ',
            'few clouds': 'ë§‘ìŒ',
            'scattered clouds': 'ë§‘ìŒ',
            'broken clouds': 'íë¦¼',
            'overcast clouds': 'íë¦¼',
            'light rain': 'ë¹„',
            'moderate rain': 'ë¹„',
            'heavy intensity rain': 'ë¹„',
            'shower rain': 'ë¹„',
            'rain': 'ë¹„',
            'thunderstorm': 'ë¹„',
            'snow': 'ëˆˆ',
            'mist': 'ì•ˆê°œ',
            'fog': 'ì•ˆê°œ',
            'haze': 'ì•ˆê°œ',
            'smoke': 'ì•ˆê°œ',
            'dust': 'ì•ˆê°œ',
            'sand': 'ì•ˆê°œ',
            'ash': 'ì•ˆê°œ',
            'squalls': 'ë¹„',
            'tornado': 'ë¹„'
        };

        const weatherIcons = {
            'ë§‘ìŒ': 'â˜€ï¸',
            'íë¦¼': 'â˜ï¸',
            'ë¹„': 'ğŸŒ§ï¸',
            'ëˆˆ': 'â„ï¸',
            'ì•ˆê°œ': 'ğŸŒ«ï¸'
        };

    fetch(url)
        .then(response => response.json())
        .then(data => {
            const weatherBody = document.getElementById('weather-body');
            const date = new Date(data.dt * 1000);
            const formattedDate = date.toISOString().split('T')[0];
            const formattedTime = date.toTimeString().split(' ')[0];
            const temp = (data.main.temp - 273.15).toFixed(2);
            const description = data.weather[0].description;
            const simplifiedDescription = weatherMapping[description] || 'ë§‘ìŒ';
            const icon = weatherIcons[simplifiedDescription] || 'â˜€ï¸';

            const recommendedMenu = temp >= 20 ? 'ë¶ˆê³ ê¸°, ì‚¼ê²¹ì‚´' : '';
            // loadRecomendMenu();
            const tableContent = `
                <tr>
                    <td>${formattedDate}</td>
                    <td>${temp}</td>
                    <td>${icon} ${simplifiedDescription}</td>
                    <td>${recommendedMenu}</td>
                </tr>
            `;

            weatherBody.innerHTML = tableContent;
        })
        .catch(error => console.error('Error fetching weather data:', error));
    });

    

    
</script>
</body>
</html>